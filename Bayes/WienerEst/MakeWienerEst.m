function [I,i,RB,W,b] = MakeWienerEst(R,B,RB,w0,Kw,n0,Kn)% [I,i,RB,W,b] = MakeWienerEst(R,B,RB,Kw,n0,Kn)%% Makes the Wiener reconstruction matrices.  These are% identical to the Bayesian reconstruction matrices under% the linear/Normal case I consider.%% The Wiener theory may be found in Pratt pp. 410 ff.%% The function MakeRawWiener does the work following Pratt% quite closely.%% Note that for the linear/Normal problem, this estimator% is equivalent to the Bayesian estimator.  The name goes% back to the time before I understood this.  See%  Brainard, D.H. (1995). An ideal observer for appearance: reconstruction%  from samples. UCSB Vision Labs Tech Report 95-1, Department of Psychology,%  UC Santa Barbara, Santa Barbara, CA. % for a derivation of the correspondence.  This report is available at:%  http://color.psych.upenn.edu/brainard/papers/bayessampling.pdf%% 7/18/94		dhb		Added this line.% Compute the matrix that maps weights to responsesif (size(RB) == [0 0])  RB = R*B;end[m,n] = size(RB);% Compute the Wiener estimator for weights[W,b] = MakeRawWiener(RB,w0,Kw,n0,Kn);% Convert to interpolation formI = B*W;i = B*b;