function peaks = FindPeaksLB(spectrum,S)% peaks = FindPeaksLB(spectrum,[S])%% Find the local peaks in a spectrum.% Uses the heuristic of requiring increasing% and decreasing in neighborhood of peak to% get rid of noise.%% 1/6/96		dhb		Wrote it.if (nargin < 2)	S = [380 5 81];endindices = [];[nWls,nil] = size(spectrum);for i = 3:nWls-2	if (spectrum(i-2) < spectrum(i-1) & ...		  spectrum(i-1) < spectrum(i) & ...			spectrum(i+1) < spectrum(i) & ...			spectrum(i+2) < spectrum(i+1) )		indices = [indices ; i];	endendwls = SToWls(S);peaks = indices;[nPeaks,nil] = size(indices);for i = 1:nPeaks	peaks(i) = wls(indices(i));end